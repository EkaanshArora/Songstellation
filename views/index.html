<!DOCTYPE html>
<html>

<head>
    <title>Spotify Easy Authentication</title>
    <script src="https://github.com/thenextweb/constellation/releases/download/v1.5.5/constellation.min.js"></script>
    <meta name="description" content="A cool thing made with Glitch">
    <link id="favicon" rel="icon" href="https://glitch.com/edit/favicon-app.ico" type="image/x-icon">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div id="main">
    <canvas id="canvas-layer-0"></canvas>
    <canvas id="canvas-layer-1" width="1000"></canvas>
    <canvas id="canvas-layer-2" width="1000"></canvas>
    <h1>
        Song Constellation
    </h1>
    <p>
        Generate a custom animated constellation based on your top spotify tracks. Made using Spotify API and
        <a href="https://github.com/thenextweb/constellation">constellation-canvas.</a>
    </p>
    <a href="/authorize">
        <div class="button">Generate constellation!</div>
    </a>
    <script>
        var w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
        var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        var c = document.getElementById("canvas-layer-0");
        c.height = h;
        c.width = w;
        var ctx = c.getContext("2d");
        var grd = ctx.createLinearGradient(0, 0, w, h);
        grd.addColorStop(0, "#020715");
        grd.addColorStop(1, "#101025");
        ctx.fillStyle = grd;
        ctx.fillRect(0, 0, w, h);

        var isMobile = {
            Android: function () {
                return navigator.userAgent.match(/Android/i);
            },
            BlackBerry: function () {
                return navigator.userAgent.match(/BlackBerry/i);
            },
            iOS: function () {
                return navigator.userAgent.match(/iPhone|iPad|iPod/i);
            },
            Opera: function () {
                return navigator.userAgent.match(/Opera Mini/i);
            },
            Windows: function () {
                return navigator.userAgent.match(/IEMobile/i);
            },
            any: function () {
                return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
            }
        };
        var fontSize = "20px",
            starSizeAfterCheck1 = 1,
            starSizeAfterCheck2 = 2,
            starSizeAfterCheck3 = 3,
            lineSizeAfterCheck = 1,
            speedAfterCheck = 0.06;
        if (isMobile.any()) {
            fontSize = "35px";
            starSizeAfterCheck1 = 2.5;
            starSizeAfterCheck2 = 1.5;
            starSizeAfterCheck3 = 7;
            lineSizeAfterCheck = 3;
            document.getElementById("page-title").style.fontSize = "4em";
            document.getElementById("page-title").style.marginTop = "2em";
            speedAfterCheck = 0.1
        }
        var constellationInstance1 = window.constellation({
            size: [w, h],
            canvas: document.getElementById('canvas-layer-1'),
            padding: [-50, -50],
            starCount: 200,
            lineCount: 0,
            fuzziness: 10,
            speed: {
                active: 0,
                passive: speedAfterCheck
            },
            style: {
                starColor: '#fff',
                lineColor: 'rgba(255,255,255,.5)',
                lineSize: 1,
                starPadding: 0,
                starSize: starSizeAfterCheck1
            },
            afterStar: (ctx, style, star) => {
                ctx.shadowBlur = 7;
                ctx.shadowColor = "white";
            }
        });

        var constellationInstance2 = window.constellation({
            size: [w, h],
            canvas: document.getElementById('canvas-layer-2'),
            padding: [-50, -50],
            starCount: 100,
            lineCount: 0,
            fuzziness: 10,
            speed: {
                active: 0,
                passive: speedAfterCheck
            },
            style: {
                starColor: '#fff',
                lineColor: 'rgba(255,255,255,.5)',
                lineSize: 1,
                starPadding: 0,
                starSize: starSizeAfterCheck2
            },
            afterStar: (ctx, style, star) => {
                ctx.shadowBlur = 15;
                ctx.shadowColor = "white";
            }
        });
    </script>
  </div>
</body>
</html>